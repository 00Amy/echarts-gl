<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>FlowGL - ECHARTS-GL</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes"> <!-- Fullscreen Landscape on iOS -->
        <link rel="stylesheet" href="./common.css">
    </head>
    <body>
        <div id="main"></div>
        <script src="../node_modules/echarts/dist/echarts.js"></script>
        <script src="../node_modules/echarts/map/js/world.js"></script>
        <script src="../dist/echarts-gl.js"></script>
        <script src="lib/jquery.min.js"></script>
        <script>
            var chart = echarts.init(document.getElementById('main'));

            $.getJSON('data/winds.json', function (windData) {
                var data = [];
                var p = 0;
                for (var j = 0; j < windData.ny; j++) {
                    for (var i = 0; i < windData.nx; i++, p++) {
                        data.push([
                            i / windData.nx * 360 - 180, j / windData.ny * 180 - 90,
                            windData.data[p][0], windData.data[p][1]
                        ]);
                    }
                }
                chart.setOption(option = {
                    geo: {
                        map: 'world',
                        roam: true,
                        label: {
                            emphasis: {
                                show: false
                            }
                        },
                        silent: true,
                        itemStyle: {
                            normal: {
                                areaColor: '#323c48',
                                borderColor: '#111'
                            },
                            emphasis: {
                                areaColor: '#2a333d'
                            }
                        }
                    },
                    series: [{
                        type: 'flowGL',
                        coordinateSystem: 'geo',
                        data: data
                    }]
                });
            });
        </script>
    </body>
</html>